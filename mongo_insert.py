import pymongo
myclient = pymongo.MongoClient('mongodb://localhost:27017/')
mydb = myclient['repo']
mydb2 = myclient['master_collection']
mycol2 = mydb2['collection']
mycol = mydb['guid_repo']
mycol1 = mydb['golden_repo']

list1 = [
{"GUID":"1234","domain":"person","Source":"Siebel","Primary_Key":"S123","Fname":"John","Lname":"Doe","address": [{"address_type": "Primary","address_line_1": "4D Ag Lavras st","city": "Kifissia","postal_code": "14561","country": "Greece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":["123-456-7809","234-456-6789"],"Email":[{"type":"Primary","emailadd":"John.doe@abc.com"},{"type":"alternate","emailadd":["j.doe@abc.com","john.d@xyz.com"]}],"degree":"PHD","isMember":"Y","okToCall":"N","Publication":3,"Consolidation_Ind":4},
{"GUID":"1234","domain":"person","Source":"Author","Primary_Key":"A123","Fname":"J","Lname":"Doe","address": [{"address_type": "Primary","address_line_1": "4D Ag Lavras st","city": "Kifissia","postal_code": "14561","country": "Greece"},{"address_type": "Work","address_line_1": "xyz Ag Lavras st","city": "Madurai","postal_code": "141561","country": "India"}],"Phone":"123-456-7809","Email":[{"type":"Primary","emailadd":"j.doe@abc.com"},{"type":"alternate","emailadd":"john.d@author.com"}],"degree":["BS","MS"],"okToCall":"N","Publication":1,"Consolidation_Ind":4},
{"GUID":"1234","domain":"person","Source":"Marketto","Primary_Key":"M123","Fname":"John","Lname":"Doe","address": [{"address_type": "Primary","address_line_1": "4D Ag Lavras st","city": "Kifissia","postal_code": "14561","country": "Greece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":["342-876-9087","234-456-6789"],"Email":[{"type":"Primary","emailadd":"John.doe@abc.com"}],"isMember":"N","okToCall":"Y","Consolidation_Ind":4},
{"GUID":"1234","domain":"person","Source":"Reviewer","Primary_Key":"R123","Fname":"Jon","Lname":"Doe","address": [{"address_type": "Primary","address_line_1": "4D Ag Lavras st","city": "Kifissia","postal_code": "14561","country": "Greece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":"234-456-6789","Email":[{"type":"Primary","emailadd":"John.doe@abc.com"},{"type":"alternate","emailadd":"jon.Doe123@test.com"}],"degree":"MS","isMember":"N","Publication":1,"Consolidation_Ind":4},
{"GUID":"4567","domain":"person","Source":"Author","Primary_Key":"A56789","Fname":"Peter","Lname":"Parker","address": [{"address_type": "Primary","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":["309-309-3098","409-409-4890"],"Email":[{"type":"Primary","emailadd":"peter.parker@spider.com"},{"type":"alternate","emailadd":["p.parker@azas.com","peter.p@xyz.com"]}],"degree":"Btech","isMember":"","okToCall":"Y","Consolidation_Ind":4},
{"GUID":"4567","domain":"person","Source":"Marketto","Primary_Key":"A56789","Fname":"Peter S","Lname":"Parker","address": [{"address_type": "Primary","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":"409-409-4890","Email":[{"type":"Primary","emailadd":"p.parker@azas.com"}],"degree":"Mtech","isMember":"N","Publication":2,"Consolidation_Ind":4},
{"GUID":"4567","domain":"person","Source":"IEEE Apps","Primary_Key":"IA3456","Fname":"P","Lname":"Park","address": [{"address_type": "Primary","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":["309-309-3098","1800-call-spiderman"],"Email":[{"type":"Primary","emailadd":"peter.parker@spider.com"},{"type":"alternate","emailadd":"peter.p@xyz.com"}],"Consolidation_Ind":4},
{"GUID":"4567","domain":"person","Source":"CEEvents","Primary_Key":"CE5678909","Fname":"Pete","Lname":"Park","address": [{"address_type": "Primary","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":["345-0987-1234","890-090-0987"],"Email":[{"type":"Primary","emailadd":"p.parker@azas.com"},{"type":"alternate","emailadd":"pete.p@abcxyz.com"}],"degree":"Mtech","isMember":"","okToCall":"Y","Publication":1,"Consolidation_Ind":4},
{"GUID":"4567","domain":"person","Source":"OpenWater","Primary_Key":"OW56789","Fname":"Petey","Lname":"Parke","address": [{"address_type": "Primary","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"},{"address_type": "Work","address_line_1": "4DD Ag Lavras st","city": "KKifissia","postal_code": "141561","country": "GGreece"}],"Phone":"309-309-3098","dateofBirth":"08/01/1962","Email":[{"type":"alternate","emailadd":"stan.lee@comic.com"}],"isMember":"","okToCall":"Y","organization":"Marvel","Consolidation_Ind":4}]

x = mycol.insert_many(list1)

list2=[{'GUID': '1234', 'source_name': 'temp_golden', 'Fname': 'John', 'Lname': 'Doe', 'Email': [{'type': 'Primary', 'emailadd': ['John.doe@abc.com', 'j.doe@abc.com']}, {'type': 'alternate', 'emailadd': ['jon.Doe123@test.com', 'john.d@xyz.com', 'j.doe@abc.com', 'john.d@author.com']}], 'Phone': ['123-456-7809', '234-456-6789', '342-876-9087'], 'address': [{'address_type': 'Work', 'address_line_1': 'xyz Ag Lavras st', 'city': 'Madurai', 'postal_code': '141561', 'country': 'India'}, {'address_type': 'Work', 'address_line_1': '4DD Ag Lavras st', 'city': 'KKifissia', 'postal_code': '141561', 'country': 'GGreece'}, {'address_type': 'Primary', 'address_line_1': '4D Ag Lavras st', 'city': 'Kifissia', 'postal_code': '14561', 'country': 'Greece'}], 'isMember': 'Y', 'okToCall': 'N', 'Publication': 5}, {'GUID': '4567', 'source_name': 'temp_golden', 'Fname': 'Peter S', 'Lname': 'Parker', 'Email': [{'type': 'Primary', 'emailadd': ['p.parker@azas.com', 'peter.parker@spider.com']}, {'type': 'alternate', 'emailadd': ['peter.p@xyz.com', 'stan.lee@comic.com', 'p.parker@azas.com', 'pete.p@abcxyz.com']}], 'Phone': ['1800-call-spiderman', '309-309-3098', '345-0987-1234', '409-409-4890', '890-090-0987'], 'address': [{'address_type': 'Primary', 'address_line_1': '4DD Ag Lavras st', 'city': 'KKifissia', 'postal_code': '141561', 'country': 'GGreece'}, {'address_type': 'Work', 'address_line_1': '4DD Ag Lavras st', 'city': 'KKifissia', 'postal_code': '141561', 'country': 'GGreece'}], 'isMember': 'N', 'okToCall': 'Y', 'Publication': 3}]

y = mycol1.insert_many(list2)

list3 = [{
  "_id": "61b047b41d83bedac90b8ecd",
  "IBUCKETPATH": "D:\Data engeering_Johnny\mongodb\POC1\guid.txt",
  "MLfileattributes": {
    "attributes": "[\"first_name\",\"last_name\",\"phone\",\"email\",\"parsed_address\"]",
    "delimiter": "|"
  },
  "WBUCKETPATH": "D:\Data engeering_Johnny\mongodb\POC1",
  "attributes": "[{\"a_name\":\"Source_Primary_Identifier\",\"a_datatype\":\"string\",\"isNull\":\"false\",\"singlevalued\":\"true\",\"columnorder\":17,\"active\":\"true\",\"Source_UID_LKP\":\"true\"},{\"a_name\":\"Unique_Id\",\"a_datatype\":\"string\",\"isNull\":\"false\",\"singlevalued\":\"true\",\"columnorder\":18,\"active\":\"true\",\"Source_UID_LKP\":\"true\"},{\"a_name\":\"record_id\",\"a_datatype\":\"string\",\"isNull\":\"false\",\"singlevalued\":\"false\",\"columnorder\":7,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"Customer_Number\",\"a_datatype\":\"string\",\"isNull\":\"false\",\"singlevalued\":\"false\",\"columnorder\":7,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"First_Name\",\"a_datatype\":\"string\",\"isNull\":\"false\",\"std_function\":\"name_std\",\"singlevalued\":\"true\",\"validation\":\"!=('John','spiderman')\",\"columnorder\":2,\"active\":\"true\",\"tags\":[\"Name\",\"F_Name\",\"First_N\"],\"Source_UID_LKP\":\"false\"},{\"a_name\":\"middle_name\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"true\",\"columnorder\":8,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"Last_Name\",\"a_datatype\":\"string\",\"isNull\":\"false\",\"std_function\":\"name_std\",\"singlevalued\":\"true\",\"validation\":\"!=('John','spiderman')\",\"columnorder\":3,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"gender\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"false\",\"columnorder\":9,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"date_of_birth\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"true\",\"columnorder\":10,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"email\",\"isNull\":\"true\",\"lvl2_att\":[{\"l2_name\":\"email_type\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":1,\"active\":\"true\"},{\"l2_name\":\"email\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"l2_order\":2,\"active\":\"true\"}],\"std_function\":\"email_std\",\"singlevalued\":\"false\",\"columnorder\":5,\"Source_UID_LKP\":\"false\"},{\"a_name\":\"parsed_address\",\"isNull\":\"true\",\"lvl2_att\":[{\"l2_name\":\"address_line_1\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":2,\"active\":\"true\"},{\"l2_name\":\"address_line_2\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":3,\"active\":\"true\"},{\"l2_name\":\"address_line_3\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":4,\"active\":\"true\"},{\"l2_name\":\"city\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":5,\"active\":\"true\"},{\"l2_name\":\"state\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":6,\"active\":\"true\"},{\"l2_name\":\"postal_code\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":7,\"active\":\"true\"},{\"l2_name\":\"country\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":8,\"active\":\"true\"},{\"l2_name\":\"address_type\",\"l2_datatype\":\"string\",\"l2_isNull\":\"true\",\"l2_order\":1,\"active\":\"true\"}],\"std_function\":\"parseadd_std\",\"singlevalued\":\"false\",\"columnorder\":6,\"Source_UID_LKP\":\"false\"},{\"a_name\":\"phone\",\"isNull\":\"true\",\"lvl2_att\":[{\"l2_name\":\"phone_type\",\"l2_datatype\":\"string\",\"isNull\":\"true\",\"l2_order\":1,\"active\":\"true\"},{\"l2_name\":\"phone\",\"l2_datatype\":\"string\",\"isNull\":\"true\",\"l2_order\":1,\"active\":\"true\"}],\"std_function\":\"phone_std\",\"singlevalued\":\"false\",\"columnorder\":4,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"employer_name\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"false\",\"columnorder\":11,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"geocode_name\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"true\",\"columnorder\":12,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"geocode_region\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"true\",\"columnorder\":13,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"type_code\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"true\",\"columnorder\":14,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"field_of_study\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"true\",\"columnorder\":15,\"active\":\"true\",\"Source_UID_LKP\":\"false\"},{\"a_name\":\"grade_decription\",\"a_datatype\":\"string\",\"isNull\":\"true\",\"singlevalued\":\"false\",\"columnorder\":16,\"active\":\"true\",\"Source_UID_LKP\":\"false\"}]",
  "domain_id": "PER123",
  "domain_name": "Person",
  "identical_match_threshold": "75",
  "no_match_threshold": "35"
}]

z = mycol2.insert_many(list3)

print(x)
print(y)
print(z)
print('done')